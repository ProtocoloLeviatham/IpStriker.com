<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LEVIATHAN | ADVANCED WARFARE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #00ff00;
            --danger: #ff0000;
            --dark: #050505;
            --glass: rgba(0, 20, 0, 0.95);
        }

        body {
            background-color: var(--dark);
            color: var(--primary);
            font-family: 'Share Tech Mono', monospace;
            overflow-x: hidden;
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            cursor: default;
        }

        /* --- EFECTOS CRT Y GLITCH --- */
        .crt::before {
            content: " ";
            display: block;
            position: absolute;
            top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 50;
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
        }
        
        .glitch-text {
            position: relative;
        }
        .glitch-text::before, .glitch-text::after {
            content: attr(data-text);
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--dark);
        }
        .glitch-text::before {
            left: 2px;
            text-shadow: -1px 0 red;
            animation: glitch-anim-1 2s infinite linear alternate-reverse;
            clip-path: inset(0 0 0 0);
        }
        .glitch-text::after {
            left: -2px;
            text-shadow: -1px 0 blue;
            animation: glitch-anim-2 3s infinite linear alternate-reverse;
            clip-path: inset(0 0 0 0);
        }

        @keyframes glitch-anim-1 {
            0% { clip-path: inset(20% 0 80% 0); }
            20% { clip-path: inset(60% 0 10% 0); }
            40% { clip-path: inset(40% 0 50% 0); }
            60% { clip-path: inset(80% 0 5% 0); }
            80% { clip-path: inset(10% 0 70% 0); }
            100% { clip-path: inset(30% 0 20% 0); }
        }
        @keyframes glitch-anim-2 {
            0% { clip-path: inset(10% 0 60% 0); }
            20% { clip-path: inset(30% 0 20% 0); }
            40% { clip-path: inset(90% 0 10% 0); }
            60% { clip-path: inset(15% 0 80% 0); }
            80% { clip-path: inset(55% 0 10% 0); }
            100% { clip-path: inset(40% 0 30% 0); }
        }

        /* --- UI COMPONENTES --- */
        .panel {
            background: var(--glass);
            border: 1px solid var(--primary);
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.1);
            position: relative;
            z-index: 60; 
        }

        .btn-action {
            border: 1px solid var(--primary);
            color: var(--primary);
            text-transform: uppercase;
            background: rgba(0,20,0,0.8);
            transition: all 0.2s;
            cursor: pointer;
            position: relative;
            z-index: 100;
        }
        .btn-action:hover:not(:disabled) {
            background: var(--primary);
            color: black;
            box-shadow: 0 0 20px var(--primary);
        }
        .btn-action:disabled {
            border-color: #333;
            color: #555;
            cursor: not-allowed;
        }

        /* Vector Card Selection */
        .vector-card {
            border: 1px solid #333;
            transition: transform 0.2s, box-shadow 0.2s;
            opacity: 0.6;
            cursor: pointer;
            position: relative;
            z-index: 60;
            background: rgba(0, 10, 0, 0.6);
        }
        .vector-card:hover {
            opacity: 1;
            transform: scale(1.02);
            z-index: 70;
            border-color: var(--primary);
        }
        .vector-card.selected {
            opacity: 1;
            box-shadow: 0 0 15px inset;
            border-width: 2px;
        }

        /* Scrollbars */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: #001100; }
        ::-webkit-scrollbar-thumb { background: #0f0; }

        /* API Data Grid */
        .api-row {
            display: grid;
            grid-template-columns: 140px 1fr;
            border-bottom: 1px solid #003300;
            padding: 4px 0;
            font-size: 0.70rem;
        }
        .api-key { color: #00aa00; font-weight: bold; text-transform: uppercase; }
        .api-val { color: #ccffcc; word-break: break-all; text-align: right;}

        /* Animaciones */
        @keyframes scanline {
            0% { transform: translateY(-100%); }
            100% { transform: translateY(100%); }
        }
        .scan-line {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 20px;
            background: rgba(0, 255, 0, 0.1);
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.2);
            animation: scanline 2s linear infinite;
            pointer-events: none;
            z-index: 40;
        }

        /* Grid Pattern Background for graphs */
        .bg-grid-pattern {
            background-image: linear-gradient(rgba(255, 0, 0, 0.1) 1px, transparent 1px),
            linear-gradient(90deg, rgba(255, 0, 0, 0.1) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        #bg-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }
        
        input, button { cursor: text; }
        button { cursor: pointer; }
        
        /* --- ESTILO DE TERMINAL LINUX REALISTA --- */
        .terminal-line {
            font-family: 'Fira Code', 'Courier New', monospace;
            white-space: pre-wrap;
            word-break: break-all;
            margin-bottom: 1px;
            padding-left: 4px;
            border-left: 2px solid transparent;
            line-height: 1.3;
            font-size: 11px;
            color: #ccc; /* Texto base gris claro */
            animation: termSlide 0.1s ease-out forwards;
            opacity: 0;
            transform: translateY(5px);
        }
        .terminal-line:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        @keyframes termSlide {
            0% { opacity: 0; transform: translateY(5px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        
        /* Sintaxis de colores REALISTA (Estilo Syslog/Tcpdump) */
        .ts-time { color: #666; font-size: 0.9em; margin-right: 5px; } /* Gris oscuro */
        .ts-proc { color: #888; font-weight: bold; } /* Proceso en gris */
        
        .ts-ip { color: #e5e5e5; } /* Blanco casi puro para IPs */
        .ts-port { color: #aaa; } /* Gris para puertos */
        .ts-proto { color: #999; } 
        
        .ts-info { color: #bbb; } /* Texto informativo standard */
        .ts-warn { color: #d4d4d4; font-weight: bold; } /* Alerta sutil */
        .ts-err { color: #ff5555; } /* Rojo terminal */
        .ts-suc { color: #55ff55; } /* Verde terminal */
        
        .ts-dim { color: #444; } /* Comentarios oscuros */
        .ts-data { color: #777; } /* Datos hexadecimales */

        /* Ticker Animation */
        .ticker-wrap {
            width: 100%;
            overflow: hidden;
            white-space: nowrap;
            box-sizing: border-box;
        }
        .ticker {
            display: inline-block;
            padding-left: 100%;
            animation: ticker 30s linear infinite;
        }
        @keyframes ticker {
            0%   { transform: translate3d(0, 0, 0); }
            100% { transform: translate3d(-100%, 0, 0); }
        }
    </style>
</head>
<body class="crt text-sm md:text-base selection:bg-green-500 selection:text-black">

    <canvas id="bg-canvas"></canvas>
    <div class="scan-line"></div>

    <div class="relative z-10 container mx-auto p-4 flex-grow flex flex-col">
        
        <header class="text-center mb-4 pt-4 border-b border-green-800 pb-4 relative z-60">
            <h1 class="text-4xl md:text-7xl font-bold mb-2 glitch-text tracking-widest" data-text="LEVIATHAN">LEVIATHAN</h1>
            <div class="flex flex-col md:flex-row justify-between items-center text-[10px] md:text-sm text-green-600 px-4 mt-2 font-mono gap-1">
                <span>CIA_CYBER_CMD::NODE_ALPHA</span>
                <span id="real-network-stats" class="text-xs text-yellow-500 border border-yellow-800 px-2 py-1 bg-black/50">
                    CALCULANDO RED...
                </span>
                <span class="animate-pulse text-red-500 font-bold">/// UNAUTHORIZED ACCESS ///</span>
                <span>V.6.8.5 (STABLE)</span>
            </div>
        </header>

        <div id="terms-panel" class="panel p-4 mb-6 border-l-4 border-l-red-600 relative overflow-hidden group">
            <div class="absolute top-0 right-0 p-2 opacity-20 text-6xl">⚖️</div>
            <h3 class="text-xl text-red-500 font-bold mb-2 border-b border-red-800 pb-2 flex items-center gap-2">
                <span class="animate-pulse">⚠</span> PROTOCOLO DE USO
            </h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div id="terms-text" class="text-[10px] md:text-sm text-green-300 font-light leading-relaxed font-mono h-24 md:h-auto overflow-y-auto"></div>
                <div class="hidden md:flex flex-col justify-center items-center border border-red-900 bg-red-950/20 p-2">
                    <div class="text-red-500 text-center font-bold text-lg mb-1 glitch-text" data-text="ADVERTENCIA FEDERAL">ADVERTENCIA FEDERAL</div>
                    <p class="text-red-400 text-[10px] text-center">
                        ESTA HERRAMIENTA DISPARA ATAQUES REALES SIMULADOS.<br>
                        USO EXCLUSIVO PARA PRUEBAS DE PENETRACIÓN AUTORIZADAS.<br>
                        <span class="text-white bg-red-600 px-1 mt-1 inline-block font-bold">TERMINACIÓN INMEDIATA</span>
                    </p>
                </div>
            </div>
        </div>

        <main id="viewport" class="flex-grow flex flex-col items-center w-full transition-all relative z-60">

            <section id="sec-target" class="w-full max-w-4xl panel p-6 md:p-8 rounded relative animate-[fadeIn_0.5s]">
                <div class="flex items-center mb-4">
                    <div class="w-3 h-3 bg-green-500 rounded-full animate-ping mr-3"></div>
                    <h2 class="text-xl md:text-2xl font-bold tracking-widest">TARGET LOCK SYSTEM</h2>
                </div>

                <div class="mb-6 relative">
                    <label class="text-[10px] text-green-600 font-bold uppercase mb-1 block">Ingrese Objetivo (IP / Dominio / MAC)</label>
                    
                    <div class="flex flex-col md:flex-row shadow-[0_0_20px_rgba(0,255,0,0.2)] relative z-50 gap-2 md:gap-0">
                        <span class="bg-green-900/30 text-green-500 p-3 md:p-4 border border-green-700 items-center justify-center text-xl font-bold hidden md:flex">></span>
                        
                        <input type="text" id="ip-input" placeholder="192.168.1.1" 
                            class="w-full flex-grow bg-black border border-green-700 text-green-400 p-3 md:p-4 text-lg md:text-xl outline-none focus:bg-green-900/10 font-bold tracking-wider placeholder-green-900 cursor-text">
                        
                        <div class="flex w-full md:w-auto">
                            <button onclick="resetTarget()" id="btn-reset-target" class="hidden bg-red-900/80 text-red-500 px-4 font-bold border border-green-700 hover:bg-red-600 hover:text-white transition-all cursor-pointer mr-2 md:mr-0 md:border-l-0">X</button>
                            <button onclick="trackTarget()" id="btn-track" class="w-full md:w-auto btn-action px-4 md:px-8 py-3 md:py-4 font-bold text-lg flex items-center justify-center gap-2 hover:bg-green-500 hover:text-black whitespace-nowrap">
                                <span>⌖</span> LOCALIZAR
                            </button>
                        </div>
                    </div>
                </div>

                <div class="flex flex-wrap gap-2 md:gap-4 mb-6 text-xs relative z-50 justify-center md:justify-start">
                    <label class="flex items-center gap-2 cursor-pointer hover:text-white bg-green-900/20 p-2 border border-green-800 rounded">
                        <input type="radio" name="ttype" value="ip" checked class="accent-green-500 cursor-pointer" onchange="updatePlaceholder(this.value)"> IPv4 / IPv6
                    </label>
                    <label class="flex items-center gap-2 cursor-pointer hover:text-white bg-green-900/20 p-2 border border-green-800 rounded">
                        <input type="radio" name="ttype" value="mac" class="accent-green-500 cursor-pointer" onchange="updatePlaceholder(this.value)"> MAC ADDR (L2)
                    </label>
                    <label class="flex items-center gap-2 cursor-pointer hover:text-white bg-green-900/20 p-2 border border-green-800 rounded">
                        <input type="radio" name="ttype" value="web" class="accent-green-500 cursor-pointer" onchange="updatePlaceholder(this.value)"> WEB SERVER
                    </label>
                </div>

                <div id="api-console" class="hidden border-t-2 border-green-600 pt-4 mt-4 bg-black p-4 h-64 md:h-80 overflow-y-auto font-mono text-xs relative z-50">
                    <div class="text-green-500 mb-2 font-bold flex justify-between">
                        <span>[+] FULL DATA DUMP INTERCEPTED</span><span class="animate-pulse">LIVE FEED</span>
                    </div>
                    <div id="api-output" class="space-y-1"></div>
                </div>

                <div id="api-error" class="hidden mt-4 p-4 bg-red-900/30 border border-red-500 text-red-500 font-bold text-center animate-pulse">
                    [!] ERROR CRÍTICO DE ENLACE [!]<br><span class="text-xs font-normal">Reintentando conexión satelital...</span>
                </div>

                <button id="btn-next-config" onclick="showConfig()" disabled class="w-full mt-4 btn-action py-4 hidden font-bold text-lg md:text-xl tracking-[0.2em] animate-[pulse_2s_infinite] cursor-pointer relative z-100 bg-green-900/40 border-2 border-green-500 hover:bg-green-500 hover:text-black">INICIAR CONFIGURACIÓN DE VECTORES >></button>
            </section>

            <section id="sec-config" class="hidden w-full max-w-6xl animate-[fadeIn_0.5s] mb-20">
                <div class="panel p-4 md:p-6 border-t-4 border-t-green-500">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-end mb-8 border-b border-green-900 pb-2">
                        <h2 class="text-2xl md:text-3xl font-bold">ATTACK VECTOR CONFIG</h2>
                        <div class="text-left md:text-right mt-2 md:mt-0">
                            <div class="text-xs text-green-600">LOCKED TARGET</div>
                            <div id="config-target-ip" class="text-lg md:text-xl font-bold text-white">0.0.0.0</div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 mb-8">
                        <div class="vector-card p-3 border-green-600" onclick="selectVector('UDP FLOOD', 'green')">
                            <div class="flex justify-between items-center mb-2"><h4 class="font-bold text-green-400 text-sm">UDP FLOOD</h4><span class="text-[9px] border border-green-500 px-1">L4</span></div>
                            <div class="h-1 bg-green-900 w-full mb-2"><div class="h-full bg-green-500 w-1/4"></div></div>
                            <p class="text-[9px] text-gray-400">Volcado de datagramas UDP aleatorios. Saturación de ancho de banda.</p>
                        </div>
                        <div class="vector-card p-3 border-yellow-600" onclick="selectVector('ICMP ECHO', 'yellow')">
                            <div class="flex justify-between items-center mb-2"><h4 class="font-bold text-yellow-400 text-sm">ICMP SWARM</h4><span class="text-[9px] border border-yellow-500 px-1">L3</span></div>
                            <div class="h-1 bg-yellow-900 w-full mb-2"><div class="h-full bg-yellow-500 w-1/2"></div></div>
                            <p class="text-[9px] text-gray-400">Ping flood masivo. Sobrecarga de peticiones de eco al router.</p>
                        </div>
                        <div class="vector-card p-3 border-orange-600" onclick="selectVector('TCP SYN', 'orange')">
                            <div class="flex justify-between items-center mb-2"><h4 class="font-bold text-orange-500 text-sm">TCP SYN</h4><span class="text-[9px] border border-orange-500 px-1">L4</span></div>
                            <div class="h-1 bg-orange-900 w-full mb-2"><div class="h-full bg-orange-500 w-3/4"></div></div>
                            <p class="text-[9px] text-gray-400">Agotamiento de sockets. Llena la tabla de estados del servidor.</p>
                        </div>
                        <div class="vector-card p-3 border-red-500 relative overflow-hidden group" onclick="selectVector('DNS AMP', 'red')">
                            <div class="flex justify-between items-center mb-2 relative z-10"><h4 class="font-bold text-red-500 text-sm">DNS AMP</h4><span class="text-[9px] bg-red-600 text-black font-bold px-1">L4+</span></div>
                            <div class="h-1 bg-red-900 w-full mb-2"><div class="h-full bg-red-500 w-full animate-pulse"></div></div>
                            <p class="text-[9px] text-red-300 relative z-10">Reflexión amplificada x70 usando Resolvers públicos.</p>
                        </div>
                        <div class="vector-card p-3 border-purple-500 relative overflow-hidden group" onclick="selectVector('LAYER 7 HTTP-FLOOD', 'purple')">
                             <div class="absolute inset-0 bg-purple-600/10 animate-pulse"></div>
                            <div class="flex justify-between items-center mb-2 relative z-10"><h4 class="font-bold text-purple-400 text-sm">LAYER 7</h4><span class="text-[9px] bg-purple-600 text-black font-bold px-1 animate-pulse">HTTP</span></div>
                            <div class="h-1 bg-purple-900 w-full mb-2"><div class="h-full bg-purple-500 w-full"></div></div>
                            <p class="text-[9px] text-purple-300 relative z-10">Peticiones GET/POST masivas simulando tráfico humano real.</p>
                        </div>
                    </div>

                    <div class="mb-8 p-4 bg-black/50 border border-green-800">
                        <h4 class="text-xs text-green-500 mb-2 font-bold uppercase">Temporizador de Operación (TIEMPO REAL)</h4>
                        <div class="flex flex-col md:flex-row gap-2 md:gap-4">
                            <button onclick="setDuration(10)" class="dur-btn flex-1 py-3 border border-green-800 text-sm hover:bg-green-900 transition-colors cursor-pointer font-bold">10 MIN (TEST)</button>
                            <button onclick="setDuration(30)" class="dur-btn flex-1 py-3 border border-green-800 text-sm hover:bg-green-900 transition-colors cursor-pointer font-bold">30 MIN (LEVE)</button>
                            <button onclick="setDuration(60)" class="dur-btn flex-1 py-3 border border-green-800 text-sm hover:bg-green-900 transition-colors cursor-pointer font-bold">1 HORA (FULL)</button>
                        </div>
                    </div>

                    <div class="flex flex-col md:flex-row justify-end gap-4">
                        <button onclick="resetSystem()" class="order-2 md:order-1 px-6 py-3 border border-gray-600 text-gray-500 hover:text-white cursor-pointer w-full md:w-auto">CANCELAR</button>
                        <button id="btn-launch" onclick="startSimulation()" disabled class="order-1 md:order-2 w-full md:w-auto px-10 py-4 border-2 border-red-800 bg-black text-red-700 font-bold text-xl uppercase tracking-widest opacity-50 cursor-not-allowed transition-all clip-path-polygon z-100">LANZAR ATAQUE</button>
                    </div>
                </div>
            </section>

            <section id="sec-sim" class="hidden fixed inset-0 bg-black z-[200] flex flex-col p-2 md:p-4 overflow-hidden">
                <div class="flex flex-col md:flex-row justify-between items-start mb-2 border-b-2 border-red-600 pb-2 bg-black shrink-0">
                    <div>
                        <div class="text-2xl md:text-4xl text-red-600 font-black glitch-text" data-text="ATAQUE EN PROGRESO">ATAQUE EN PROGRESO</div>
                        <div class="text-[10px] md:text-xs text-red-400 font-mono mt-1 flex flex-wrap gap-2 md:gap-4">
                            <span>OBJETIVO: <span id="sim-target-display" class="text-white font-bold">---</span></span>
                            <span>VECTOR: <span id="sim-vector-display" class="text-white font-bold border px-1 border-red-500">---</span></span>
                        </div>
                    </div>
                    <div class="text-right mt-2 md:mt-0">
                        <div id="timer-display" class="text-4xl md:text-6xl font-mono text-red-500 font-bold">00:00:00</div>
                    </div>
                </div>

                <div class="flex-grow flex flex-col lg:grid lg:grid-cols-12 gap-2 md:gap-4 overflow-hidden mb-16 md:mb-20">
                    <div class="lg:col-span-8 bg-black border border-green-900 p-2 font-mono text-xs relative flex flex-col h-2/3 lg:h-auto">
                        <div class="absolute top-0 left-0 w-full h-8 bg-gradient-to-b from-black to-transparent z-10"></div>
                        <h4 class="text-green-600 border-b border-green-800 mb-2 pb-1 flex justify-between shrink-0">
                            <span>TERMINAL: TRAFICO SALIENTE (RAW)</span><span class="animate-pulse text-red-500">LIVE</span>
                        </h4>
                        <div id="packet-log" class="flex-grow overflow-hidden flex flex-col justify-end p-1"></div>
                    </div>

                    <div class="lg:col-span-4 flex flex-col gap-2 md:gap-4 h-1/3 lg:h-auto">
                        
                        <div class="h-full bg-red-950/10 border border-red-900 p-2 flex flex-col justify-center items-center relative overflow-hidden shrink-0 bg-grid-pattern">
                            <div class="absolute inset-0 bg-red-500/5 animate-pulse"></div>
                            <div class="text-red-500 text-[10px] tracking-[0.2em] mb-1 uppercase animate-pulse z-10">ANCHO DE BANDA ENVIADO</div>
                            <div class="flex items-end gap-2 z-10">
                                <span id="bytes-val" class="text-3xl md:text-5xl font-bold text-white glitch-text" data-text="00.00">00.00</span>
                                <span id="unit-val" class="text-sm md:text-xl text-red-500 font-bold mb-1">MB</span>
                            </div>
                            <div class="w-full h-1 bg-red-900 mt-2 overflow-hidden z-10">
                                <div class="h-full bg-red-500 w-1/2 animate-[translateX_1s_infinite_linear]"></div>
                            </div>
                            <div class="text-xs text-red-800 font-mono mt-2" id="real-ping-display">LATENCIA REAL: -- ms</div>
                        </div>
                    </div>
                </div>

                <div class="fixed bottom-0 left-0 w-full p-2 md:p-4 bg-black border-t-2 border-red-600 z-50 flex justify-center">
                    <button onclick="abortSequence()" class="w-full md:w-auto bg-transparent text-red-600 border-2 border-red-600 px-4 md:px-12 py-2 md:py-3 font-bold text-lg md:text-xl hover:bg-red-600 hover:text-black transition-all shadow-[0_0_30px_rgba(255,0,0,0.4)] uppercase tracking-widest cursor-pointer">⚠️ ABORTAR (KILL SWITCH) ⚠️</button>
                </div>

                <div id="abort-screen" class="hidden absolute inset-0 bg-black z-[210] p-4 md:p-8 font-mono text-sm md:text-lg text-red-500 flex flex-col justify-end pb-20">
                    <div id="abort-terminal" class="space-y-1"></div>
                </div>
            </section>
        </main>

        <footer class="w-full border-t border-green-900 bg-black/95 p-2 text-[10px] md:text-xs font-mono relative z-50 overflow-hidden">
            <div class="ticker-wrap border-b border-green-900 mb-2 pb-1 bg-black text-green-700">
                <div class="ticker">
                    +++ SYSTEM ALERT: NEW CVE-2025-9981 DETECTED +++ NODE ALPHA ACTIVE +++ ENCRYPTION: AES-256-GCM +++ NSA/CSS SURVEILLANCE BLOCKED +++ PROXY CHAIN: 192.168.1.5 -> 10.0.0.8 -> 172.16.55.1 +++ LEVIATHAN CORE V.6.8.5 STABLE +++
                </div>
            </div>

            <div class="container mx-auto flex flex-col md:flex-row justify-between items-center opacity-80 gap-2">
                <div class="flex flex-col items-center md:items-start">
                    <span class="glitch-text font-bold tracking-[0.2em] text-green-500 text-sm" data-text="INDUSTRIAS LEVIATHAM">INDUSTRIAS LEVIATHAM © 2018-2025</span>
                    <span class="text-[9px] text-gray-500">MILITARY GRADE CYBER WARFARE SUITE</span>
                </div>
                
                <div class="flex gap-4 text-green-900 font-bold border border-green-900/50 p-1 px-2 bg-green-900/10">
                    <span class="text-green-600">RAM: <span class="text-green-400">16.4 GB</span></span>
                    <span class="text-green-600">CLIENT_IP: <span id="client-ip-display" class="text-red-400">DETECTING...</span></span>
                    <span class="text-green-600">UTC: <span id="utc-clock" class="text-white">00:00:00</span></span>
                </div>
           </div>
        </footer>

    </div>

    <script>
        const termsHTML = `
            <div class="mb-2">> INICIANDO SISTEMA DE SIMULACIÓN DE GUERRA CIBERNÉTICA... [OK]</div>
            <div class="mb-2">> DESCRIPCIÓN DE ARSENAL DISPONIBLE:</div>
            <ul class="list-none pl-2 space-y-1">
                <li><span class="text-green-500 font-bold">1. UDP FLOOD (L4):</span> Envío masivo de paquetes basura. Causa <span class="text-red-500 font-bold animate-pulse">SATURACIÓN DE ANCHO DE BANDA</span>.</li>
                <li><span class="text-yellow-500 font-bold">2. ICMP SWARM (L3):</span> Sobrecarga de peticiones Echo. Provoca <span class="text-red-500 font-bold animate-pulse">COLAPSO DEL ROUTER</span>.</li>
                <li><span class="text-orange-500 font-bold">3. TCP SYN (L4):</span> Inicia conexiones falsas sin cerrarlas. Genera <span class="text-red-500 font-bold animate-pulse">AGOTAMIENTO DE RECURSOS (RAM/CPU)</span>.</li>
                <li><span class="text-red-500 font-bold">4. DNS AMP (Reflejado):</span> Usa servidores públicos para multiplicar el ataque x70. <span class="text-red-500 font-bold animate-pulse">DAÑO CRÍTICO ESTRUCTURAL</span>.</li>
                <li><span class="text-purple-500 font-bold">5. LAYER 7 HTTP:</span> Simula tráfico humano real. Indetectable por firewalls simples. <span class="text-red-500 font-bold animate-pulse">CAÍDA DE SERVICIO WEB</span>.</li>
            </ul>
            <div class="mt-2 text-gray-400">> TODA ACCIÓN ES REGISTRADA LOCALMENTE.</div>
        `;

        const termsContainer = document.getElementById('terms-text');
        
        window.onload = () => {
            initCanvas();
            animateBg();
            monitorNetwork(); 
            startClock();
            detectClientIP();
            setTimeout(() => {
                termsContainer.innerHTML = termsHTML;
            }, 500);
        };

        function startClock() {
            setInterval(() => {
                const now = new Date();
                document.getElementById('utc-clock').innerText = now.toISOString().split('T')[1].split('.')[0] + " Z";
            }, 1000);
        }

        async function detectClientIP() {
            try {
                const req = await fetch('https://api.ipify.org?format=json');
                const data = await req.json();
                document.getElementById('client-ip-display').innerText = data.ip;
            } catch(e) {
                document.getElementById('client-ip-display').innerText = "HIDDEN/VPN";
            }
        }

        const canvas = document.getElementById('bg-canvas');
        const ctx = canvas.getContext('2d');
        let width, height, particles = [];

        function initCanvas() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            particles = [];
            for(let j=0; j<60; j++) {
                particles.push({
                    x: Math.random()*width, y: Math.random()*height,
                    vx: (Math.random()-0.5)*0.5, vy: (Math.random()-0.5)*0.5
                });
            }
        }
        window.onresize = initCanvas;

        function animateBg() {
            ctx.clearRect(0,0,width,height);
            ctx.strokeStyle = 'rgba(0, 150, 0, 0.15)';
            ctx.fillStyle = '#0f0';
            particles.forEach((p, index) => {
                p.x += p.vx; p.y += p.vy;
                if(p.x < 0 || p.x > width) p.vx *= -1;
                if(p.y < 0 || p.y > height) p.vy *= -1;
                ctx.beginPath();
                ctx.arc(p.x, p.y, 1, 0, Math.PI*2);
                ctx.fill();
                particles.slice(index+1).forEach(p2 => {
                    if(Math.hypot(p.x-p2.x, p.y-p2.y) < 100) {
                        ctx.beginPath();
                        ctx.moveTo(p.x, p.y);
                        ctx.lineTo(p2.x, p2.y);
                        ctx.stroke();
                    }
                });
            });
            requestAnimationFrame(animateBg);
        }

        function monitorNetwork() {
            const statsEl = document.getElementById('real-network-stats');
            const simPingEl = document.getElementById('real-ping-display');

            async function checkPing() {
                const start = performance.now();
                try {
                    await fetch('https://www.google.com/favicon.ico', { mode: 'no-cors', cache: 'no-store' });
                    const end = performance.now();
                    const ping = Math.round(end - start);
                    
                    let connType = 'UNKNOWN';
                    if (navigator.connection) {
                        connType = navigator.connection.effectiveType ? navigator.connection.effectiveType.toUpperCase() : 'WIFI/ETH';
                        if(navigator.connection.downlink) {
                           connType += ` | BW: ~${navigator.connection.downlink}Mbps`;
                        }
                    }

                    const statusText = `NET: ${connType} | RTT: ${ping}ms`;
                    statsEl.innerText = statusText;
                    if(simPingEl) simPingEl.innerText = `LATENCIA REAL SISTEMA: ${ping} ms`;
                    
                    if(ping < 50) statsEl.className = "text-xs text-green-500 border border-green-800 px-2 py-1 bg-black/50";
                    else if(ping < 150) statsEl.className = "text-xs text-yellow-500 border border-yellow-800 px-2 py-1 bg-black/50";
                    else statsEl.className = "text-xs text-red-500 border border-red-800 px-2 py-1 bg-black/50";

                } catch (e) {
                    statsEl.innerText = "NET: OFFLINE / BLOCKED";
                    statsEl.className = "text-xs text-red-600 border border-red-800 px-2 py-1 bg-black/50";
                }
            }
            setInterval(checkPing, 2000);
            checkPing();
        }

        let state = { ip: '', vector: null, duration: 0, timers: [], totalBytes: 0 };

        function updatePlaceholder(val) {
            const input = document.getElementById('ip-input');
            if(val === 'ip') input.placeholder = "192.168.1.1";
            else if(val === 'mac') input.placeholder = "00:1A:2B:3C:4D:5E";
            else if(val === 'web') input.placeholder = "www.google.com";
        }

        async function trackTarget() {
            const input = document.getElementById('ip-input').value.trim();
            const type = document.querySelector('input[name="ttype"]:checked').value;

            if(!input) return alert("¡ERROR! DEBE INGRESAR UN OBJETIVO.");
            
            state.ip = input;
            const btn = document.getElementById('btn-track');
            const output = document.getElementById('api-output');
            const consoleDiv = document.getElementById('api-console');
            const nextBtn = document.getElementById('btn-next-config');
            const resetBtn = document.getElementById('btn-reset-target');

            btn.innerHTML = `<span class="animate-spin">⚙</span> INITIALIZING...`;
            consoleDiv.classList.add('hidden');
            nextBtn.classList.add('hidden');
            output.innerHTML = '';
            
            let finalData = {};
            let isMacMode = (type === 'mac');

            try {
                let targetIP = input;
                if (type === 'web') {
                    if (!/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/.test(input)) {
                        try {
                            const dnsReq = await fetch(`https://dns.google/resolve?name=${input}&type=A`);
                            const dnsJson = await dnsReq.json();
                            if (dnsJson.Answer) {
                                targetIP = dnsJson.Answer[dnsJson.Answer.length - 1].data; 
                                finalData["[DNS] RESOLVED_IP"] = targetIP;
                            }
                        } catch (e) {}
                    }
                }

                if (type === 'mac') {
                    if (input.includes('.') && !input.includes(':')) {
                         finalData["WARNING"] = "DOMAIN DETECTED IN MAC INPUT";
                         finalData["AUTO_CORRECT"] = "VIRTUALIZING NIC...";
                         finalData["MAC_ADDRESS"] = "52:54:00:" + Math.floor(Math.random()*99).toString() + ":" + Math.floor(Math.random()*99).toString() + ":" + Math.floor(Math.random()*99).toString();
                         finalData["VENDOR"] = "Virtual Bridge (Auto-Generated)";
                         finalData["STATUS"] = "ACTIVE (TUNNELED)";
                    } else {
                        const macDB = {
                            "00:1A:2B": "Cisco Systems", "00:0C:29": "VMware", "F0:98:9D": "Apple",
                            "B8:27:EB": "Raspberry Pi", "24:77:03": "Intel", "50:E5:49": "Giga-Byte",
                            "00:D8:61": "TP-LINK", "C8:3A:35": "Tenda", "00:E0:4C": "Realtek",
                            "D8:50:E6": "Asus", "FC:AA:14": "Giga-Byte", "00:25:90": "Super Micro"
                        };
                        const clean = input.toUpperCase().replace(/[^A-F0-9]/g, "").substring(0,6);
                        
                        try {
                            const req = await fetch(`https://api.maclookup.app/v2/macs/${input}`);
                            if(req.ok) {
                                const json = await req.json();
                                if(json.found) finalData["VENDOR"] = json.company;
                            }
                        } catch(e) {}

                        if(!finalData["VENDOR"]) {
                             for(let key in macDB) {
                                 if(clean.startsWith(key.replace(/:/g,""))) finalData["VENDOR"] = macDB[key];
                             }
                        }
                        if(!finalData["VENDOR"]) finalData["VENDOR"] = "PRIVATE / UNKNOWN OUI";
                        
                        finalData["MAC_ADDR"] = input;
                        finalData["L2_PROTOCOL"] = "ETHERNET II";
                        finalData["FRAME_CHECK"] = "VALID";
                    }
                }

                if (!isMacMode) {
                    const p1 = fetch(`https://ipapi.co/${targetIP}/json/`).then(r=>r.json()).catch(e=>({}));
                    const p2 = fetch(`https://ipwho.is/${targetIP}`).then(r=>r.json()).catch(e=>({}));
                    const p3 = fetch(`https://api.databat.io/v1/ip/${targetIP}`).then(r=>r.json()).catch(e=>({}));

                    const [d1, d2, d3] = await Promise.all([p1, p2, p3]);

                    finalData["TARGET_IP"] = targetIP;
                    finalData["HOSTNAME"] = d2.connection?.domain || d1.org || "Unknown";
                    finalData["CONTINENT"] = d2.continent || d1.continent_code;
                    finalData["COUNTRY"] = `${d2.country || d1.country_name} ${d2.flag?.emoji || ''}`;
                    finalData["REGION"] = d2.region || d1.region;
                    finalData["CITY"] = d2.city || d1.city;
                    finalData["ZIP_CODE"] = d2.postal || d1.postal;
                    finalData["COORDINATES"] = `${d2.latitude || d1.latitude}, ${d2.longitude || d1.longitude}`;
                    finalData["ASN"] = d2.connection?.asn || d1.asn;
                    finalData["ISP"] = d2.connection?.isp || d1.org;
                    finalData["ORG"] = d2.connection?.org || d1.org;
                    finalData["TIMEZONE"] = d2.timezone?.id || d1.timezone;
                    finalData["UTC_OFFSET"] = d2.timezone?.utc || d1.utc_offset;
                    finalData["CURRENCY"] = `${d2.currency?.name} (${d2.currency?.symbol})`;
                    finalData["IS_VPN"] = d2.security?.vpn ? "YES" : "NO (Clean)";
                    finalData["IS_PROXY"] = d2.security?.proxy ? "YES" : "NO";
                    finalData["IS_HOSTING"] = d2.security?.hosting ? "YES" : "NO";
                    
                    if (type === 'web') {
                        finalData["SERVER_HEADER"] = "nginx/1.18.0 (Ubuntu)";
                        finalData["X-POWERED-BY"] = "PHP/8.1";
                        finalData["PORT_443"] = "OPEN (HTTPS)";
                        finalData["PORT_80"] = "OPEN (HTTP)";
                        finalData["WAF_STATUS"] = "DETECTED (Generic)";
                    }
                }

                // DEFINICIÓN DE GENERADOR DE LOGS "REALISTA"
                window.generatePacketLog = function() {
                    const now = new Date();
                    const timeStr = now.toLocaleTimeString('es-AR', { hour12: false }) + "." + now.getMilliseconds().toString().padStart(3, '0');
                    const ts = `<span class="ts-time">[${timeStr}]</span>`;
                    
                    const sport = Math.floor(Math.random() * 65535);
                    const pid = Math.floor(Math.random() * 32000);
                    const spoof = `${Math.floor(Math.random()*223)}.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`;
                    
                    let log = "";
                    let size = 64;

                    // --- GENERADOR MEJORADO Y VARIADO v6.8 ---
                    
                    if (state.vector && state.vector.name === 'LAYER 7 HTTP-FLOOD') {
                        const methods = ["GET", "POST", "HEAD", "PUT", "OPTIONS", "DELETE"];
                        const agents = ["Mozilla/5.0 (Windows NT 10.0; Win64; x64)", "curl/7.68.0", "Go-http-client/1.1", "Python/3.9", "Apache-HttpClient/4.5.13", "Mediapartners-Google"];
                        const paths = ["/login", "/", "/api/v1/auth", "/admin", "/wp-login.php", "/search", "/assets/main.css", "/images/logo.png", "/robots.txt", "/.env"];
                        const target = `<span class="ts-ip">${state.ip}</span>`;
                        const src = `<span class="ts-ip">${spoof}</span>`;
                        
                        const scenarios = [
                            `${ts} <span class="ts-proc">nginx[${pid}]:</span> ${src} - - [${new Date().toUTCString()}] "${methods[0]} ${paths[Math.floor(Math.random()*paths.length)]} HTTP/1.1" 200 ${Math.floor(Math.random()*5000)} "-" "${agents[0]}"`,
                            `${ts} <span class="ts-warn">[WAF]</span> ModSecurity: Access denied with code 403 (phase 2). Pattern match "SQLi" at ARGS:id.`,
                            `${ts} <span class="ts-info">OUTBOUND</span> >> ${methods[1]} ${target}${paths[1]} | Payload: <span class="ts-data">${Math.random().toString(36).substring(7)}</span> | Keep-Alive`,
                            `${ts} <span class="ts-err">CONNECTION TIMEOUT</span> ${target}:443 (Upstream Server Unreachable)`,
                            `${ts} <span class="ts-suc">SSL Handshake</span> with ${target} success. Protocol: TLSv1.3 Cipher: TLS_AES_256_GCM_SHA384`,
                            `${ts} <span class="ts-proc">httpd[${pid}]:</span> [core:error] [pid ${pid}] (70007)The timeout specified has expired: [client ${src}] AH00524: Handler for fastcgi-script returned invalid result`,
                            `${ts} <span class="ts-info">Slowloris:</span> Holding socket open... (Thread-${pid}) - 24s elapsed`,
                            `${ts} <span class="ts-warn">[DOS]</span> High request rate detected from ${src}. Throttling via iptables.`,
                            `${ts} <span class="ts-info">GET</span> ${target}/static/image.jpg HTTP/2 | 200 OK | 45ms | Cache: MISS`,
                            `${ts} <span class="ts-err">502 Bad Gateway</span> received from ${target}. Reverse proxy error.`,
                            `${ts} <span class="ts-dim">DEBUG:</span> Header injection: X-Forwarded-For: ${spoof}`,
                            `${ts} <span class="ts-proc">botnet:</span> Executing challenge-response bypass. Cookie acquired.`
                        ];
                        log = scenarios[Math.floor(Math.random() * scenarios.length)];
                        size = Math.floor(Math.random() * 2000) + 200;

                    } else if (state.vector && state.vector.name === 'TCP SYN') {
                        const target = `<span class="ts-ip">${state.ip}</span>`;
                        const src = `<span class="ts-ip">${spoof}</span>`;
                        const port = `<span class="ts-port">80</span>`;
                        
                        const scenarios = [
                            `${ts} <span class="ts-proc">KERNEL:</span> TCP: ${src}:${sport} > ${target}:${port} Flags <span class="ts-warn">[S]</span>, seq ${Math.floor(Math.random()*999999)}, win 65535, len 0`,
                            `${ts} <span class="ts-info">netfilter:</span> DROP IN=eth0 OUT= MAC=ff:ff:ff:ff:ff:ff SRC=${src} DST=${target} PROTO=TCP SPT=${sport} DPT=80 SYN`,
                            `${ts} <span class="ts-err">TCP:</span> Possible SYN flooding on port 80. Sending cookies.`,
                            `${ts} <span class="ts-info">tcpreplay:</span> Sending packet ${pid} to ${target} via interface eth0`,
                            `${ts} <span class="ts-proc">firewall:</span> [BLOCK] Suspicious SYN packet from ${src}. State: INVALID`,
                            `${ts} <span class="ts-info">TCP:</span> ${target}:${port} > ${src}:${sport} Flags [R.], seq 0, win 0, length 0`,
                            `${ts} <span class="ts-warn">sock:</span> TCP connection reset by peer ${target}`,
                            `${ts} <span class="ts-data">Raw:</span> 4500 003c 1a2b 4000 4006 .... (SYN Payload)`,
                            `${ts} <span class="ts-info">Handshake:</span> SYN SENT -> Waiting ACK... (Timeout 3000ms)`,
                            `${ts} <span class="ts-suc">ZOMBIE:</span> Bot ${src} joined the swarm. Target: ${target}`,
                            `${ts} <span class="ts-dim">nf_conntrack:</span> table full, dropping packet.`,
                            `${ts} <span class="ts-info">TCP Window:</span> Zero window probe sent to ${target}`
                        ];
                        log = scenarios[Math.floor(Math.random() * scenarios.length)];
                        size = 60;

                    } else if (state.vector && state.vector.name === 'DNS AMP') {
                        const resolvers = ["8.8.8.8", "1.1.1.1", "9.9.9.9", "208.67.222.222", "4.2.2.2"];
                        const res = `<span class="ts-ip">${resolvers[Math.floor(Math.random()*resolvers.length)]}</span>`;
                        const target = `<span class="ts-ip">${state.ip}</span>`;
                        
                        const scenarios = [
                            `${ts} <span class="ts-info">IP</span> ${target} (SPOOFED) > ${res}: ${pid}+ <span class="ts-proto">ANY?</span> isc.org. (41)`,
                            `${ts} <span class="ts-suc">REFLECT:</span> Received ${Math.floor(Math.random()*4000)} bytes from ${res} -> ${target} (Amplification 64x)`,
                            `${ts} <span class="ts-warn">named[${pid}]:</span> client ${target}#${sport}: query (cache) './NS/IN' denied`,
                            `${ts} <span class="ts-info">DNS:</span> Standard query response 0x${Math.floor(Math.random()*9999).toString(16)} TXT (Amplified)`,
                            `${ts} <span class="ts-err">udp sum bad:</span> ${target} > ${res} domain [b2&3=0x1]`,
                            `${ts} <span class="ts-info">DrDoS:</span> Amplification factor x74. Target link saturated.`,
                            `${ts} <span class="ts-proc">resolver:</span> Querying ${res} for "gov" IN ANY (EDNS0 set)`,
                            `${ts} <span class="ts-warn">[ALERT]</span> Large DNS response packet detected (3400 bytes). Fragmentation required.`,
                            `${ts} <span class="ts-info">IP</span> ${res} > ${target}: ${pid}* 4/0/1 . NS a.root-servers.net`,
                            `${ts} <span class="ts-suc">Traffic:</span> Injected 400pps via open resolver ${res}`,
                            `${ts} <span class="ts-dim">dnscap:</span> [${res}] -> [${target}] DNSKEY response detected`
                        ];
                        log = scenarios[Math.floor(Math.random() * scenarios.length)];
                        size = 1200;

                    } else if (state.vector && state.vector.name === 'ICMP ECHO') {
                        const target = `<span class="ts-ip">${state.ip}</span>`;
                        const src = `<span class="ts-ip">${spoof}</span>`;
                        
                        const scenarios = [
                            `${ts} <span class="ts-info">IP</span> ${src} > ${target}: ICMP echo request, id ${pid}, seq ${Math.floor(Math.random()*1000)}, length 64`,
                            `${ts} <span class="ts-warn">frag needed</span> and DF set (mtu 1500) ICMP ${target} > ${src}: destination unreachable`,
                            `${ts} <span class="ts-info">PING</span> ${target} (${target}) 56(84) bytes of data.`,
                            `${ts} <span class="ts-err">Request timeout</span> for icmp_seq ${Math.floor(Math.random()*100)}`,
                            `${ts} <span class="ts-info">IP</span> ${target} > ${src}: ICMP echo reply, id ${pid}, seq ${Math.floor(Math.random()*1000)}`,
                            `${ts} <span class="ts-proc">kernel:</span> ICMP: redirect from ${target} on eth0`,
                            `${ts} <span class="ts-warn">Flood:</span> Sending 10000 pings/sec to ${target}. Socket buffer full.`,
                            `${ts} <span class="ts-info">Traceroute:</span> ${target}: hops=30, time=45ms`,
                            `${ts} <span class="ts-err">ICMP:</span> Destination Host Unreachable from ${src}`,
                            `${ts} <span class="ts-data">Packet:</span> Type=8 Code=0 Checksum=0x${Math.floor(Math.random()*9999).toString(16)}`,
                            `${ts} <span class="ts-suc">POD:</span> Ping of Death fragment sent to ${target}`
                        ];
                        log = scenarios[Math.floor(Math.random() * scenarios.length)];
                        size = 84;

                    } else { // UDP
                        const target = `<span class="ts-ip">${state.ip}</span>`;
                        const src = `<span class="ts-ip">${spoof}</span>`;
                        
                        const scenarios = [
                            `${ts} <span class="ts-dim">0x0000:</span> 4500 05dc ${Math.floor(Math.random()*9999)} 0000 4011 .... ${state.ip.split('.').map(n=>parseInt(n).toString(16).padStart(2,'0')).join('')}`,
                            `${ts} <span class="ts-info">UDP:</span> Packet injected. Len=${Math.floor(Math.random()*1400)} Src=${src} Dst=${target}`,
                            `${ts} <span class="ts-warn">[DROP]</span> UDP Fragment offset wrong. Dropped by kernel.`,
                            `${ts} <span class="ts-info">IP</span> ${src}.${sport} > ${target}.${Math.floor(Math.random()*65535)}: UDP, length 1400`,
                            `${ts} <span class="ts-err">ICMP</span> ${target} udp port ${Math.floor(Math.random()*65535)} unreachable`,
                            `${ts} <span class="ts-suc">Bandwidth:</span> Saturating uplink... 500Mbps sent`,
                            `${ts} <span class="ts-info">Payload:</span> Junk data sent to ${target} (Randomized)`,
                            `${ts} <span class="ts-proc">eth0:</span> TX bytes:${Math.floor(Math.random()*999999)} packets:${Math.floor(Math.random()*500)} errors:0 dropped:0`,
                            `${ts} <span class="ts-warn">Congestion:</span> Network buffer full. Dropping frames at queue tail.`,
                            `${ts} <span class="ts-data">Binary:</span> 01010110 11001010 10101010 11110000 [Flooding]`
                        ];
                        log = scenarios[Math.floor(Math.random() * scenarios.length)];
                        size = 1000;
                    }

                    return { html: `<div class="terminal-line">${log}</div>`, size: size * (Math.random() * 50 + 10) };
                };

                function renderObject(obj, prefix = '') {
                    for(let key in obj) {
                        if(obj[key] !== undefined && typeof obj[key] !== 'object') {
                            output.innerHTML += `<div class="api-row"><span class="api-key">${prefix}${key}</span><span class="api-val">${obj[key]}</span></div>`;
                        }
                    }
                }
                
                renderObject(finalData);
                consoleDiv.classList.remove('hidden');
                
                btn.innerHTML = `<span>✓</span> TARGET LOCKED`;
                btn.classList.add('bg-green-600', 'text-black');
                nextBtn.classList.remove('hidden');
                nextBtn.disabled = false; 
                nextBtn.style.cursor = "pointer";
                resetBtn.classList.remove('hidden');

            } catch (e) {
                console.error("Critical Fail:", e);
                output.innerHTML = `<div class="api-row"><span class="api-key text-red-500">FATAL ERROR</span><span class="api-val">NETWORK UNREACHABLE</span></div>`;
                consoleDiv.classList.remove('hidden');
                btn.innerHTML = `<span>X</span> FAIL`;
                btn.classList.add('bg-red-900');
                resetBtn.classList.remove('hidden');
            }
        }

        function resetTarget() {
            const input = document.getElementById('ip-input');
            const btn = document.getElementById('btn-track');
            const output = document.getElementById('api-output');
            const consoleDiv = document.getElementById('api-console');
            const nextBtn = document.getElementById('btn-next-config');
            const resetBtn = document.getElementById('btn-reset-target');

            input.value = '';
            input.focus();
            state.ip = '';
            btn.innerHTML = `<span>⌖</span> LOCALIZAR`;
            btn.classList.remove('bg-green-600', 'text-black', 'bg-red-900', 'bg-yellow-600');
            consoleDiv.classList.add('hidden');
            nextBtn.classList.add('hidden');
            resetBtn.classList.add('hidden');
            output.innerHTML = '';
        }

        function showConfig() {
            document.getElementById('sec-target').classList.add('hidden');
            document.getElementById('sec-config').classList.remove('hidden');
            document.getElementById('config-target-ip').innerText = state.ip;
        }

        function selectVector(name, color) {
            document.querySelectorAll('.vector-card').forEach(c => c.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            state.vector = { name, color };
            checkLaunch();
        }

        function setDuration(min) {
            document.querySelectorAll('.dur-btn').forEach(b => {
                b.classList.remove('bg-green-500', 'text-black');
            });
            event.target.classList.add('bg-green-500', 'text-black');
            state.duration = min;
            checkLaunch();
        }

        function checkLaunch() {
            const btn = document.getElementById('btn-launch');
            if(state.vector && state.duration) {
                btn.disabled = false;
                btn.classList.remove('opacity-50', 'cursor-not-allowed');
                btn.classList.add('hover:bg-red-600', 'hover:text-black', 'shadow-[0_0_20px_#f00]');
                btn.style.cursor = "pointer";
                if(state.vector.color === 'red' || state.vector.color === 'purple') {
                    btn.classList.add('animate-pulse');
                } else {
                    btn.classList.remove('animate-pulse');
                }
            }
        }

        function startSimulation() {
            document.getElementById('sec-config').classList.add('hidden');
            document.getElementById('sec-sim').classList.remove('hidden');
            document.getElementById('sim-target-display').innerText = state.ip;
            const vecDisplay = document.getElementById('sim-vector-display');
            vecDisplay.innerText = state.vector.name;
            const colors = { green: '#0f0', yellow: '#ff0', orange: '#ffa500', red: '#f00', purple: '#a855f7' };
            vecDisplay.style.borderColor = colors[state.vector.color];
            vecDisplay.style.color = colors[state.vector.color];
            
            // Reiniciar Bytes
            state.totalBytes = 0;
            
            runTimer(state.duration * 60);
            runAttackLoops();
        }

        function runTimer(seconds) {
            let t = seconds;
            const el = document.getElementById('timer-display');
            state.timers.push(setInterval(() => {
                const h = Math.floor(t/3600).toString().padStart(2,'0');
                const m = Math.floor((t%3600)/60).toString().padStart(2,'0');
                const s = (t%60).toString().padStart(2,'0');
                el.innerText = `${h}:${m}:${s}`;
                t--;
                if(t<0) abortSequence();
            }, 1000));
        }

        function runAttackLoops() {
            const logBox = document.getElementById('packet-log');
            const byteEl = document.getElementById('bytes-val');
            const unitEl = document.getElementById('unit-val');
            
            // Velocidad variable según el ataque
            const speed = state.vector.name.includes("HTTP") ? 60 : 40; 
            
            state.timers.push(setInterval(() => {
                const packetData = window.generatePacketLog ? window.generatePacketLog() : {html: "Initializing...", size: 0};
                
                // Insertar HTML directamente (contiene el div con la animación)
                // Usamos insertAdjacentHTML para mejor performance
                logBox.insertAdjacentHTML('beforeend', packetData.html);
                
                // Scroll al fondo
                if(logBox.children.length > 25) {
                    logBox.removeChild(logBox.firstChild);
                }
                logBox.scrollTop = logBox.scrollHeight;
                
                // --- CÁLCULO DE ANCHO DE BANDA ---
                state.totalBytes += packetData.size;

                const PB = 1024 * 1024 * 1024 * 1024 * 1024;

                let displayVal = 0;
                let displayUnit = 'MB';

                if (state.totalBytes > PB) {
                    byteEl.innerText = "☠️"; 
                    byteEl.setAttribute('data-text', "∞");
                    unitEl.innerText = "INCALCULABLE";
                    unitEl.classList.add("text-red-500", "animate-pulse");
                } else {
                    unitEl.classList.remove("animate-pulse");
                    if (state.totalBytes < 1024 * 1024 * 1024) {
                        displayVal = (state.totalBytes / (1024 * 1024)).toFixed(2);
                        displayUnit = 'MB';
                    } else if (state.totalBytes < 1024 * 1024 * 1024 * 1024) {
                        displayVal = (state.totalBytes / (1024 * 1024 * 1024)).toFixed(2);
                        displayUnit = 'GB';
                    } else {
                        displayVal = (state.totalBytes / (1024 * 1024 * 1024 * 1024)).toFixed(2);
                        displayUnit = 'TB';
                    }
                    byteEl.innerText = displayVal;
                    byteEl.setAttribute('data-text', displayVal);
                    unitEl.innerText = displayUnit;
                }

            }, speed));
        }

        function abortSequence() {
            state.timers.forEach(clearInterval);
            const screen = document.getElementById('abort-screen');
            const term = document.getElementById('abort-terminal');
            screen.classList.remove('hidden');
            const commands = ["WARNING: MANUAL KILL SWITCH ENGAGED", "SIGINT sent to all child processes...", "Stopping packet injection... [OK]", "Flushing RAM buffers... [OK]", "Shredding local logs... [OK]", "Dropping VPN tunnel... [OK]", "SYSTEM HALTED."];
            let i = 0;
            const interval = setInterval(() => {
                if(i < commands.length) {
                    const line = document.createElement('div');
                    line.innerText = "> " + commands[i];
                    if(i === 0) line.className = "text-xl md:text-2xl font-bold blink-red mb-4";
                    else if (i === commands.length -1) line.className = "text-white mt-4 font-bold";
                    term.appendChild(line);
                    i++;
                } else {
                    clearInterval(interval);
                    setTimeout(resetSystem, 2000);
                }
            }, 600);
        }

        function resetSystem() { location.reload(); }
    </script>
</body>
</html>
